/*! fractal-explorer v0.1.0 | 2017-08-19 | (c) Bennett Zhang | https://github.com/bennett-zhang/fractal-explorer */

!function e(t,n,r){function a(o,s){if(!n[o]){if(!t[o]){var l="function"==typeof require&&require;if(!s&&l)return l(o,!0);if(i)return i(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[o]={exports:{}};t[o][0].call(c.exports,function(e){var n=t[o][1][e];return a(n||e)},c,c.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)a(r[o]);return a}({1:[function(e,t,n){"use strict";function r(e,t){var n=e.length;if(n!==t.length)throw"Need an equal count of xs and ys.";if(0===n)return function(){return 0};if(1===n){var r=+t[0];return function(){return r}}for(var a=[],i=0;i<n;i++)a.push(i);a.sort(function(t,n){return e[t]<e[n]?-1:1});var o=e,s=t;e=[],t=[];for(var l=0;l<n;l++)e.push(+o[a[l]]),t.push(+s[a[l]]);for(var u=[],c=[],f=[],m=0;m<n-1;m++){var g=e[m+1]-e[m],v=t[m+1]-t[m];c.push(g),u.push(v),f.push(v/g)}for(var d=[f[0]],h=0;h<c.length-1;h++){var p=f[h],z=f[h+1];if(p*z<=0)d.push(0);else{var S=c[h],y=c[h+1],b=S+y;d.push(3*b/((b+y)/p+(b+S)/z))}}d.push(f[f.length-1]);for(var x=[],C=[],w=0;w<d.length-1;w++){var _=d[w],E=f[w],A=1/c[w],M=_+d[w+1]-E-E;x.push((E-_-M)*A),C.push(M*A*A)}return function(n){var r=e.length-1;if(n===e[r])return t[r];for(var a=0,i=void 0,o=C.length-1;a<=o;){i=Math.floor((a+o)/2);var s=e[i];if(s<n)a=i+1;else{if(!(s>n))return t[i];o=i-1}}r=Math.max(0,o);var l=n-e[r],u=l*l;return t[r]+d[r]*l+x[r]*u+C[r]*l*u}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t){for(var n=[],a=[],i=[],o=[],s=0;s<e.length;s++){var l=e[s];n.push(l[0]);var u=l[1];a.push((u>>16&255)/255),i.push((u>>8&255)/255),o.push((255&u)/255)}for(var c=r(n,a),f=r(n,i),m=r(n,o),g=[],v=1/t,d=0;d<1;d+=v)g.push(c(d),f(d),m(d),255);return g}},{}],2:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(){S.text("Showing Julia set for c = "+x.constant.real+" + "+x.constant.imag+"i")}function i(e,t,n,r){e.$canvas=$(t),e.canvas=e.$canvas[0],e.gl=(0,d.initGl)(e),e.program=(0,d.initProgram)(e),e.uniforms=(0,d.getUniforms)(e,["realMin","imagMin","isJulia","jconstant","overCanvas","maxIterations","palette"]),e.bounds=n,r&&(e.gl.uniform1i(e.uniforms.isJulia,!0),e.constant=r,a()),e.gl.uniform4fv(e.uniforms.palette,y)}function o(e){var t=e.$canvas,n=e.canvas,r=e.gl;n.width=t.width(),n.height=t.height(),r.viewport(0,0,n.width,n.height),l(e),u(e)}function s(){o(b),o(x)}function l(e){var t=e.canvas,n=e.bounds;n.real.range=Math.abs(n.real.range),n.imag.range=Math.abs(n.imag.range);var r=n.real.range/n.imag.range,a=t.width/t.height;r<a?n.real.range=n.imag.range*a:r>a&&(n.imag.range=n.real.range/a),n.real.min=n.real.mid-n.real.range/2,n.real.max=n.real.mid+n.real.range/2,n.imag.min=n.imag.mid-n.imag.range/2,n.imag.max=n.imag.mid+n.imag.range/2,n.overCanvas=n.real.range/t.width}function u(e){var t=e.gl,n=e.uniforms,r=e.bounds,a=e.constant;r.overCanvas<1.1920929e-7&&console.log("unrounded: "+r.overCanvas.toString(2)+"\nrounded:     "+Math.fround(r.overCanvas).toString(2)),t.uniform1f(n.realMin,r.real.min),t.uniform1f(n.imagMin,r.imag.min),t.uniform1f(n.overCanvas,r.overCanvas),a&&t.uniform2f(n.jconstant,a.real,a.imag),t.uniform1i(n.maxIterations,C),(0,d.renderGl)(t)}function c(e,t,n){var r=e.bounds;return{real:r.real.min+t*r.overCanvas,imag:r.imag.max-n*r.overCanvas}}function f(e){var t=e.bounds;p.keydown(function(n){switch(n.which){case 37:case 65:t.real.mid-=t.real.range*w,l(e);break;case 38:case 87:n.shiftKey?(t.real.range/=_,t.imag.range/=_):t.imag.mid+=t.imag.range*w,l(e);break;case 39:case 68:t.real.mid+=t.real.range*w,l(e);break;case 40:case 83:n.shiftKey?(t.real.range*=_,t.imag.range*=_):t.imag.mid-=t.imag.range*w,l(e);break;case 48:C=1e3;break;case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:C=100*(n.which-48);break;case 187:C+=100;break;case 189:C-=100}u(e)})}function m(e){var t=e.$canvas,n=(e.canvas,e.bounds);t.mousedown(function(r){function i(t){t.preventDefault();var i=t.clientX-s.left,o=t.clientY-s.top,g=c(e,i,o);if(r.shiftKey)x.constant=g,a(),u(x);else{var v=c(e,f,m);f=i,m=o,n.real.mid+=v.real-g.real,n.imag.mid+=v.imag-g.imag,l(e),u(e)}}function o(e){e.preventDefault(),p.off("mousemove",i),p.off("mouseup",o),z.removeClass("alias all-scroll")}r.preventDefault();var s=t.offset(),f=r.clientX-s.left,m=r.clientY-s.top;r.shiftKey?(x.constant=c(e,f,m),a(),u(x),z.addClass("alias")):z.addClass("all-scroll"),p.mousemove(i),p.mouseup(o)})}function g(e){var t=e.$canvas,n=e.bounds;t.on("wheel",function(r){r.preventDefault();var a=t.offset(),i=r.clientX-a.left,o=r.clientY-a.top;r.originalEvent.deltaY<0?(n.real.range/=_,n.imag.range/=_,z.addClass("zoom-in")):(n.real.range*=_,n.imag.range*=_,z.addClass("zoom-out"));var s=c(e,i,o);l(e);var f=c(e,i,o);n.real.mid-=f.real-s.real,n.imag.mid-=f.imag-s.imag,l(e),u(e),clearTimeout($.data(t,"scrollTimer")),$.data(t,"scrollTimer",setTimeout(function(){return z.removeClass("zoom-in zoom-out")},250))})}var v=r(e("./color-gradient.js")),d=e("./webgl-utils.js"),h=r(e("./split.js")),p=$(window),z=$("html"),S=$("#julia-constant-text"),y=(0,v.default)([[0,0],[.1,4458565],[.2,8198728],[.3,13004599],[.4,15788371],[.5,16777215],[.6,10021265],[.7,5753262],[.8,2382746],[.9,463174],[1,0]],512),b={};i(b,"#mandelbrot-canvas",{real:{min:null,mid:-.7,max:null,range:3},imag:{min:null,mid:0,max:null,range:2.4},overCanvas:null});var x={};i(x,"#julia-canvas",{real:{min:null,mid:0,max:null,range:3.6},imag:{min:null,mid:0,max:null,range:3.6},overCanvas:null},{real:-.77,imag:-.09});var C=200,w=.05,_=1.1;$(s),p.resize(s),(0,h.default)(["#mandelbrot-canvas-wrapper","#julia-canvas-wrapper"],{direction:"horizontal",cursor:"col-resize",onDrag:s}),f(b),f(x),m(b),m(x),g(b),g(x)},{"./color-gradient.js":1,"./split.js":3,"./webgl-utils.js":4}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n.default=a;var a;!function(e,a){"object"===(void 0===n?"undefined":r(n))&&void 0!==t?t.exports=a():"function"==typeof define&&define.amd?define(a):e.Split=a()}(void 0,function(){var e=window,t=e.document,r="addEventListener",i="removeEventListener",o="getBoundingClientRect",s=function(){return!1},l=e.attachEvent&&!e[r],u=["","-webkit-","-moz-","-o-"].filter(function(e){var n=t.createElement("div");return n.style.cssText="width:"+e+"calc(9px)",!!n.style.length}).shift()+"calc",c=function(e){return"string"==typeof e||e instanceof String?t.querySelector(e):e};return n.default=a=function(n,a){function f(e,t,n){var r=R(y,t,n);Object.keys(r).forEach(function(t){return e.style[t]=r[t]})}function m(e,t){var n=D(y,t);Object.keys(n).forEach(function(t){return e.style[t]=n[t]})}function g(e){var t=C[this.a],n=C[this.b],r=t.size+n.size;t.size=e/this.size*r,n.size=r-e/this.size*r,f(t.element,t.size,this.aGutterSize),f(n.element,n.size,this.bGutterSize)}function v(e){var t;this.dragging&&((t="touches"in e?e.touches[0][b]-this.start:e[b]-this.start)<=C[this.a].minSize+j+this.aGutterSize?t=C[this.a].minSize+this.aGutterSize:t>=this.size-(C[this.b].minSize+j+this.bGutterSize)&&(t=this.size-(C[this.b].minSize+this.bGutterSize)),g.call(this,t),a.onDrag&&a.onDrag())}function d(){var e=C[this.a].element,t=C[this.b].element;this.size=e[o]()[y]+t[o]()[y]+this.aGutterSize+this.bGutterSize,this.start=e[o]()[x]}function h(){var t=this,n=C[t.a].element,r=C[t.b].element;t.dragging&&a.onDragEnd&&a.onDragEnd(),t.dragging=!1,e[i]("mouseup",t.stop),e[i]("touchend",t.stop),e[i]("touchcancel",t.stop),t.parent[i]("mousemove",t.move),t.parent[i]("touchmove",t.move),delete t.stop,delete t.move,n[i]("selectstart",s),n[i]("dragstart",s),r[i]("selectstart",s),r[i]("dragstart",s),n.style.userSelect="",n.style.webkitUserSelect="",n.style.MozUserSelect="",n.style.pointerEvents="",r.style.userSelect="",r.style.webkitUserSelect="",r.style.MozUserSelect="",r.style.pointerEvents="",t.gutter.style.cursor="",t.parent.style.cursor=""}function p(t){var n=this,i=C[n.a].element,o=C[n.b].element;!n.dragging&&a.onDragStart&&a.onDragStart(),t.preventDefault(),n.dragging=!0,n.move=v.bind(n),n.stop=h.bind(n),e[r]("mouseup",n.stop),e[r]("touchend",n.stop),e[r]("touchcancel",n.stop),n.parent[r]("mousemove",n.move),n.parent[r]("touchmove",n.move),i[r]("selectstart",s),i[r]("dragstart",s),o[r]("selectstart",s),o[r]("dragstart",s),i.style.userSelect="none",i.style.webkitUserSelect="none",i.style.MozUserSelect="none",i.style.pointerEvents="none",o.style.userSelect="none",o.style.webkitUserSelect="none",o.style.MozUserSelect="none",o.style.pointerEvents="none",n.gutter.style.cursor=G,n.parent.style.cursor=G,d.call(n)}function z(e){e.forEach(function(t,n){if(n>0){var r=T[n-1],a=C[r.a],i=C[r.b];a.size=e[n-1],i.size=t,f(a.element,a.size,r.aGutterSize),f(i.element,i.size,r.bGutterSize)}})}function S(){T.forEach(function(e){e.parent.removeChild(e.gutter),C[e.a].element.style[y]="",C[e.b].element.style[y]=""})}void 0===a&&(a={});var y,b,x,C,w=c(n[0]).parentNode,_=e.getComputedStyle(w).flexDirection,E=a.sizes||n.map(function(){return 100/n.length}),A=void 0!==a.minSize?a.minSize:100,M=Array.isArray(A)?A:n.map(function(){return A}),U=void 0!==a.gutterSize?a.gutterSize:10,j=void 0!==a.snapOffset?a.snapOffset:30,O=a.direction||"horizontal",G=a.cursor||("horizontal"===O?"ew-resize":"ns-resize"),L=a.gutter||function(e,n){var r=t.createElement("div");return r.className="gutter gutter-"+n,r},R=a.elementStyle||function(e,t,n){var r={};return"string"==typeof t||t instanceof String?r[e]=t:r[e]=l?t+"%":u+"("+t+"% - "+n+"px)",r},D=a.gutterStyle||function(e,t){return n={},n[e]=t+"px",n;var n};"horizontal"===O?(y="width","clientWidth",b="clientX",x="left","paddingLeft"):"vertical"===O&&(y="height","clientHeight",b="clientY",x="top","paddingTop");var T=[];return C=n.map(function(e,t){var a,i={element:c(e),size:E[t],minSize:M[t]};if(t>0&&(a={a:t-1,b:t,dragging:!1,isFirst:1===t,isLast:t===n.length-1,direction:O,parent:w},a.aGutterSize=U,a.bGutterSize=U,a.isFirst&&(a.aGutterSize=U/2),a.isLast&&(a.bGutterSize=U/2),"row-reverse"===_||"column-reverse"===_)){var s=a.a;a.a=a.b,a.b=s}if(!l&&t>0){var u=L(t,O);m(u,U),u[r]("mousedown",p.bind(a)),u[r]("touchstart",p.bind(a)),w.insertBefore(u,i.element),a.gutter=u}0===t||t===n.length-1?f(i.element,i.size,U/2):f(i.element,i.size,U);var g=i.element[o]()[y];return g<i.minSize&&(i.minSize=g),t>0&&T.push(a),i}),l?{setSizes:z,destroy:S}:{setSizes:z,getSizes:function(){return C.map(function(e){return e.size})},collapse:function(e){if(e===T.length){var t=T[e-1];d.call(t),l||g.call(t,t.size-t.bGutterSize)}else{var n=T[e];d.call(n),l||g.call(n,n.aGutterSize)}},destroy:S}},a})},{}],4:[function(e,t,n){"use strict";function r(e,t,n){var r=e.createShader(n),o=void 0;return"fractal.vert"===t?o=a:"fractal.frag"===t&&(o=i),o?(e.shaderSource(r,o),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS)?r:(alert("An error occured compiling the shaders: "+e.getShaderInfoLog(r)),null)):(alert("Could not find shader source: "+t),null)}Object.defineProperty(n,"__esModule",{value:!0}),n.initGl=function(e){var t=e.canvas,n=t.getContext("webgl")||t.getContext("experimental-webgl");return n||(alert("Unable to initialize WebGL. Your browser may not support it."),null)},n.initProgram=function(e){var t=e.gl,n=r(t,"fractal.vert",t.VERTEX_SHADER),a=r(t,"fractal.frag",t.FRAGMENT_SHADER),i=t.createProgram();if(t.attachShader(i,n),t.attachShader(i,a),t.linkProgram(i),!t.getProgramParameter(i,t.LINK_STATUS))return alert("Unable to initialize the shader program: "+t.getProgramInfoLog(i)),null;t.useProgram(i);var s=t.getAttribLocation(i,"vertexPosition");t.enableVertexAttribArray(s);var l=t.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,l),t.vertexAttribPointer(s,2,t.FLOAT,!1,0,0),t.bufferData(t.ARRAY_BUFFER,new Float32Array(o.reduce(function(e,t){return e.concat(t)})),t.STATIC_DRAW),i},n.getUniforms=function(e,t){for(var n=e.gl,r=e.program,a={},i=0;i<t.length;i++){var o=t[i];a[o]=n.getUniformLocation(r,o)}return a},n.renderGl=function(e){e.clear(e.COLOR_BUFFER_BIT),e.drawArrays(e.TRIANGLE_FAN,0,o.length)};var a="\nattribute vec4 vertexPosition;\n\nvoid main() {\n\tgl_Position = vertexPosition;\n}\n",i="\nprecision highp float;\n\nuniform float realMin;\nuniform float imagMin;\nuniform float overCanvas;\nuniform bool isJulia;\nuniform vec2 jconstant;\nuniform int maxIterations;\nconst float BAILOUT_RADIUS = 4.0;\nconst int NUM_COLORS = 512;\nuniform vec4 palette[NUM_COLORS];\nconst float GRADIENT_SCALE = float(NUM_COLORS) / 32.0;\n\nvec4 getFractalColor(vec2 z) {\n\tvec2 zSq;\n\tvec2 c;\n\tif (isJulia)\n\t\tc = jconstant;\n\telse\n\t\tc = z;\n\n\tfor (int i = 0; i < 10000; i++) {\n\t\tzSq = vec2(z.x * z.x, z.y * z.y);\n\t\tz = vec2(zSq.x - zSq.y + c.x, 2.0 * z.x * z.y + c.y);\n\n\t\tif (zSq.x + zSq.y > BAILOUT_RADIUS) {\n\t\t\tfor (int j = 0; j < 3; j++) {\n\t\t\t\tzSq = vec2(z.x * z.x, z.y * z.y);\n\t\t\t\tz = vec2(zSq.x - zSq.y, 2.0 * z.x * z.y) + c;\n\t\t\t}\n\n\t\t\tfloat mu = float(i) + 1.0 - log2(log(zSq.x + zSq.y) / 2.0);\n\t\t\tint index = int(mod(mu * GRADIENT_SCALE, float(NUM_COLORS)));\n\n\t\t\tfor (int j = 0; j < NUM_COLORS; j++) {\n\t\t\t\tif (j == index) {\n\t\t\t\t\treturn palette[j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (i > maxIterations) return vec4(0, 0, 0, 1);\n\t}\n}\n\nvoid main() {\n\tgl_FragColor = getFractalColor(vec2(realMin + gl_FragCoord.x * overCanvas, imagMin + gl_FragCoord.y * overCanvas));\n}\n",o=[[1,1],[1,-1],[-1,-1],[-1,1]]},{}]},{},[2]);